/* Vercel Shield Protected Runtime */
const crypto = require('crypto');
const vm = require('vm');

// --- Encrypted Payload ---
const _k = Buffer.from('d0fac25984ca65bb956cb7b4dd6dc745f091f72ede15dd341dac1a1aae4d927c', 'hex');
const _i = Buffer.from('9ebf9b77d24ea5755dab2b9b', 'hex');
const _c = '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';

// --- Lazy Loader ---
let userHandler = null;

module.exports = async (req, res) => {
    try {
        // Only decrypt on the first request (Cold Start optimization)
        if (!userHandler) {
            // 1. Decrypt
            const decipher = crypto.createDecipheriv('aes-256-gcm', _k, _i);
            const buf = Buffer.from(_c, 'base64');
            
            // Handle Auth Tag (Last 16 bytes in GCM)
            const tag = buf.subarray(buf.length - 16);
            const text = buf.subarray(0, buf.length - 16);
            decipher.setAuthTag(tag);
            
            let decrypted = decipher.update(text, null, 'utf8');
            decrypted += decipher.final('utf8');

            // 2. Fix ESM 'export default' for CommonJS
            // This regex safely converts 'export default' to 'module.exports ='
            if (decrypted.includes('export default')) {
                decrypted = decrypted.replace(/export\s+default/, 'module.exports =');
            }

            // 3. Create a VM Sandbox
            // This simulates a Node.js module environment
            const sandbox = {
                module: { exports: {} },
                require: require,      // Allow imports
                console: console,      // Allow logging
                process: process,      // Allow env vars
                Buffer: Buffer,        // Allow binary data
                fetch: global.fetch,   // Allow native fetch (Node 18+)
                setTimeout: setTimeout,
                clearTimeout: clearTimeout
            };
            
            // 4. Compile and Run in Context
            vm.createContext(sandbox);
            vm.runInContext(decrypted, sandbox);

            // 5. Extract the handler
            userHandler = sandbox.module.exports;
        }

        // --- Execute User Handler ---
        if (typeof userHandler === 'function') {
            return await userHandler(req, res);
        } else if (userHandler && typeof userHandler.default === 'function') {
            // Handle edge case where module.exports.default is set
            return await userHandler.default(req, res);
        } else {
            throw new Error("No function exported from decrypted code");
        }

    } catch (e) {
        // Error Handler: Returns JSON instead of crashing 500
        console.error("Vercel Shield Error:", e);
        res.status(500).json({
            error: "Runtime Integrity Error",
            message: e.message,
            stack: process.env.NODE_ENV === 'development' ? e.stack : undefined
        });
    }
};